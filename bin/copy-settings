#! /usr/bin/env python




def main():
    from os.path import join
    import reafile
    from sys import argv

    from optparse import OptionParser

    usage = "usage: %prog [options] FILE1 FILE2"
    description = "takes parameters and switches from FILE1 and puts them in FILE2"
    parser = OptionParser(usage=usage, description=description)
    parser.add_option(
	    "-o", "--output", dest="outfile",
	    help="Name of output file instead of same as FILE2", metavar="FILE")
    parser.add_option(
	    "-b", "--no-backup", dest="no_backup", action="store_true",
	    help="Do not write backup file")

    options, args = parser.parse_args()

    if len(args) != 2:
	import sys
	print>>sys.stderr, "Invalid number of arguments. Pass -h for help."
	sys.exit(1)

    from_file = args[0]
    to_file = args[1]

    from_rea = reafile.REAFile(from_file)
    to_rea = reafile.REAFile(to_file)

    to_rea.Parameters = from_rea.Parameters
    to_rea.Switches = from_rea.Switches

    if  options.outfile is not None:
	rea.write(options.outfile)
    else:
	if not options.no_backup:
	    import os
	    os.rename(to_file, to_file+"~")

	to_rea.write(to_file)

if __name__ == "__main__":
    main()
