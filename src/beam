

      subroutine beam_setup2d
      include 'SIZE' 
      include 'TOTAL' 
      include 'EMWAVE' 

      if (.not.(IFTE)) then
         write(6,*) 'ERR: 2d beam simulations to be TE'
         call exitt
      endif 

c...  get longitudinal arrays
      call get_longit_array  

c...  get longitudinal arrays
c     call get_ptr_longit_array  
c     call get_nel_longit_array  

      return
      end

      subroutine get_longit_array  
      include 'SIZE'
      include 'TOTAL'
      include 'EMWAVE'

      integer  e

      nelt2= 2*nelt
      call rzero (zin0  ,nelt2)
      call izero (iwork1,nelt2)

      nxyz=nx1*ny1*nz1

      do e=1,nelt
         zlmin = vlmin(xm1(1,1,1,e),nxyz)
         zlmax = vlmax(xm1(1,1,1,e),nxyz)
         zin0(1,e) = zlmin
         zin0(2,e) = zlmax
      enddo

      nsort = 2*nelt
      tol   = 1.e-5
      call reduced_sorts(zarry0,nzarry0,zin0,nsort,iwork1,tol)

      n = nx1*ny1*nz1*nelt
      call rzero (zin    ,n)
      call izero (workvec,n)
      call copy  (zin,xm1,n)

      nsort= n
      tol  = 1.e-8
      call reduced_sorts(zarry,nzarry,zin,nsort,workvec,tol)

      return
      end


